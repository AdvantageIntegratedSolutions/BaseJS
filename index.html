<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.23/angular.min.js"></script>
		<script type="text/javascript" src="https://s3.amazonaws.com/ais_libraries/BaseJS/1.0/base.min.js"></script>
		<link rel="stylesheet" type="text/css" href="https://ais.quickbase.com/db/bjbsgxy2r?a=dbpage&pageID=4">

		<script>
			var demoApp = angular.module('demoApp', []);
			
			demoApp.controller('DemoAppCtrl', function ($scope) {
				var demoDbid = "bjbsgxy3t";
				
				//Initiate connection to application
				var client = new Base();

				//Get Ticket
				var response = client.getTicket();
				$scope.ticket = response;

				//Add Record
				var newRecordHash = { 8: "Mike", 9: "Johnson" }
				var rid = client.addRecord(demoDbid, newRecordHash);
				$scope.newAddRecordId = rid;

				//Edit Record
				var editRecordHash = { 8: "Stephan", 9: "Smith" }
				var response = client.editRecord(demoDbid, rid, editRecordHash);
				$scope.numberOfUpdatedFields = response;

				//Find
				var response = client.find(demoDbid, rid);
				$scope.singleRecord = response;

				//DoQuery
				var query = "{'3'.XEX.''}"
				var response = client.doQuery(demoDbid, {"query": query})
				$scope.query1 = response;

				var qid = "1"
				var response = client.doQuery(demoDbid, {"qid": qid, "clist": "1.2.3.4.5"})
				$scope.query2 = response;

				$scope.dateCreated = Helpers.dateToString(response[0]["1"]);
				$scope.dateModified = Helpers.dateTimeToString(response[0]["2"]);

				//DoQueryCount
				var query = "{'3'.XEX.''}"
				var response = client.doQueryCount(demoDbid, query)
				$scope.queryCount = response;

				//Delete Record
				var response = client.deleteRecord(demoDbid, rid);
				$scope.deletedRecordId = response;

				var csvArray = [
					{ 8: 'Mike"s', 9: "John>s&o<n" },
					{ 8: "Step,hani'e", 9: "Wallace" },
					{ 8: "Jackson", 9: "Williams" },
					{ 8: "Martin", 9: "Douglas" }
				]
				var response = client.importRecords(demoDbid, csvArray);
				$scope.importedRids = response;

				//Purge Records
				var response = client.purgeRecords(demoDbid, "{'3'.XEX.''}")
				$scope.numberOfRecordsDeleted = response;

				//Get Schema
				var response = client.getTableFields(demoDbid);
				$scope.fields = response;

				//Get URL Param
				var param = Helpers.getUrlParam("name");
				$scope.nameParam = param;

			});
		</script>
	</head>

	<body ng-app="demoApp">
		<div class="container">
			<br>
			<div ng-controller="DemoAppCtrl">
				<table class="table table-bordered">
					<tbody>
						<tr>
							<td class="col-md-6">Ticket</td>
							<td class="col-md-6">{{ticket}}</td>
						</tr>
						<tr>
							<td>Added Record ID</td>
							<td>{{newAddRecordId}}</td>
						</tr>
						<tr>
							<td># of Edited Fields</td>
							<td>{{numberOfUpdatedFields}}</td>
						</tr>
						<tr>
							<td>Find Single Record</td>
							<td>{{singleRecord}}</td>
						</tr>
						<tr>
							<td>Query 1 Results</td>
							<td>{{query1}}</td>
						</tr>
						<tr>
							<td>Date Created</td>
							<td>{{dateCreated}}</td>
						</tr>
												<tr>
							<td>Date Modified</td>
							<td>{{dateModified}}</td>
						</tr>
						<tr>
							<td>Query 2 Results</td>
							<td>{{query2}}</td>
						</tr>
						<tr>
							<td>Query 1 Count</td>
							<td>{{queryCount}}</td>
						</tr>
						<tr>
							<td>Deleted Record ID</td>
							<td>{{deletedRecordId}}</td>
						</tr>
						<tr>
							<td>Imported Rids</td>
							<td>{{importedRids}}</td>
						</tr>
						<tr>
							<td># of Records Deleted</td>
							<td>{{numberOfRecordsDeleted}}</td>
						</tr>
						<tr>
							<td>Table Fields</td>
							<td>{{fields}}</td>
						</tr>
						<tr>
							<td>Name Param</td>
							<td>{{nameParam}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</body>
</html>