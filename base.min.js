function Base(e,t){Base.httpConnection=BaseConnect.initHttpConnection();BaseConnect.setVariables(e,t);this.getTicket=function(e){this.handle=function(e){return BaseConnect.getNode(e,"ticket")};var t={dbid:"main",action:"GetOneTimeTicket"};return BaseConnect.post(t,e,this.handle)};this.getVar=function(e,t,n){this.handle=function(e){return BaseConnect.getNode(e,"value")};var r={dbid:e,action:"GetDBvar",params:{varname:t}};return BaseConnect.post(r,n,this.handle)};this.setVar=function(e,t,n,r){this.handle=function(e){return true};var i={dbid:e,action:"SetDBvar",params:{varname:t,value:n}};return BaseConnect.post(i,r,this.handle)};this.uploadPage=function(e,t,n,r,i){this.handle=function(e){return BaseConnect.getNode(e,"pageID")};var s={pagetype:"1",pagebody:r};if(t){s["pageid"]=t}else if(n){s["pagename"]=n}var o={dbid:e,action:"AddReplaceDBPage",params:s};return BaseConnect.post(o,i,this.handle)};this.deletePage=function(e,t,n){this.handle=function(e){var t=BaseConnect.getNode(e,"errcode");if(t=="0"){return true}else{return false}};var r={dbid:e,action:"PageDelete",type:"QBI",params:{pageid:t}};return BaseConnect.post(r,n,this.handle)};this.doQuery=function(e,t,n,r){this.handle=function(e){return BaseConnect.getRecords(e,"records")};var i={fmt:"structured"};if(t.query||t.qid){if(t.query){i.query=t.query}else{i.qid=t.qid}}else{i.query="{'3'.XEX.''}"}i.clist=t.clist||"a";i.slist=t.slist;i.options=t.options;var s={dbid:e,action:"DoQuery",params:i};if(r){this.handle=r}return BaseConnect.post(s,n,this.handle)};this.doQueryCount=function(e,t,n){this.handle=function(e){return BaseConnect.getNode(e,"numMatches")};var r={dbid:e,action:"DoQueryCount",params:{query:t}};return BaseConnect.post(r,n,this.handle)};this.find=function(e,t,n){this.handle=function(e){var t=BaseConnect.getRecords(e,"records");if(t.length>0){if(t.length>1){return t}else{return t[0]}}else{return{}}};var r=[];if(Object.prototype.toString.call(t)=="[object Array]"){for(var i=0;i<t.length;i++){r.push("{'3'.EX.'"+t[i]+"'}")}}else{r.push("{'3'.EX.'"+t+"'}")}r=r.join("OR");return this.doQuery(e,{query:r},n,this.handle)};this.first=function(e,t,n){this.handle=function(e){var t=BaseConnect.getRecords(e,"records");if(t.length>0){return t[0]}else{return{}}};return this.doQuery(e,t,n,this.handle)};this.last=function(e,t,n){this.handle=function(e){var t=BaseConnect.getRecords(e,"records");if(t.length>0){return t[t.length-1]}else{return{}}};return this.doQuery(e,t,n,this.handle)};this.all=function(e,t,n){this.handle=function(e){var t=BaseConnect.getRecords(e,"records");if(t.length>0){return t}else{return{}}};if(!t){t={}}t["query"]="{'3'.XEX.''}";return this.doQuery(e,t,n,this.handle)};this.findRids=function(e,t,n){this.handle=function(e){return BaseConnect.getRids(e)};if(!t){t={}}t["clist"]="3";return this.doQuery(e,t,n,this.handle)};this.importRecords=function(e,t,n){this.handle=function(e){return BaseConnect.getNewRids(e)};var r="";var i=[];for(key in t[0]){i.push(key)}i=i.join(".");for(var s=0;s<t.length;s++){var o=t[s];var u=[];for(key in o){value=o[key];value=value.toString().replace(/"/g,'""');u.push('"'+value+'"')}u.join(",");u+="\n";r+=u}var a={dbid:e,action:"ImportFromCSV",params:{clist:i},csvData:r};return BaseConnect.post(a,n,this.handle)};this.addRecord=function(e,t,n){this.handle=function(e){return parseInt(BaseConnect.getNode(e,"rid"))};var r={dbid:e,action:"AddRecord",fieldParams:t};return BaseConnect.post(r,n,this.handle)};this.editRecord=function(e,t,n,r){this.handle=function(e){var t=BaseConnect.getNode(e,"rid");if(t){return true}else{return false}};var i={dbid:e,action:"EditRecord",fieldParams:n,params:{rid:t}};return BaseConnect.post(i,r,this.handle)};this.copyRecords=function(e,t,n){this.handle=function(e){return BaseConnect.getNode(e,"numCreated")};var r={dbid:e,action:"CopyMasterDetail",params:t};return BaseConnect.post(r,n,this.handle)};this.deleteRecord=function(e,t,n){this.handle=function(e){var t=BaseConnect.getNode(e,"rid");if(t){return true}else{return false}};var r={dbid:e,action:"DeleteRecord",params:{rid:t}};return BaseConnect.post(r,n,this.handle)};this.purgeRecords=function(e,t,n){this.handle=function(e){var t=BaseConnect.getNode(e,"num_records_deleted");return parseInt(t)};var r={dbid:e,action:"PurgeRecords",params:{query:t}};return BaseConnect.post(r,n,this.handle)};this.getUserInfo=function(e,t,n){this.handle=function(e){var t=$(e).find("user");t={id:$(t).attr("id"),firstName:$(t).find("firstName").text(),lastName:$(t).find("lastName").text(),login:$(t).find("login").text(),email:$(t).find("email").text(),screenName:$(t).find("screenName").text(),isVerified:$(t).find("isVerified").text(),externalAuth:$(t).find("externalAuth").text()};return t};if(!e){e=""}var r={dbid:"main",action:"GetUserInfo",params:{email:e}};return BaseConnect.post(r,t,this.handle)};this.getUserRoles=function(e,t){this.handle=function(e){return BaseConnect.formatUserRoles(e)};var n={dbid:e,action:"UserRoles"};return BaseConnect.post(n,t,this.handle)};this.changeUserRole=function(e,t,n,r,i){this.handle=function(e){return true};var s={dbid:e,userId:t,roleId:n,action:"ChangeUserRole"};if(r){s["newRoleId"]=r}return BaseConnect.post(s,i,this.handle)};this.getTableFields=function(e,t){this.handle=function(e){return BaseConnect.getFields(e)};var n={dbid:e,action:"GetSchema"};return BaseConnect.post(n,t,this.handle)};this.getTableReports=function(e,t){this.handle=function(e){return BaseConnect.getReports(e)};var n={dbid:e,action:"GetSchema"};return BaseConnect.post(n,t,this.handle)}}var BaseHelpers={getUrlParam:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return n==null?"":decodeURIComponent(n[1].replace(/\+/g," "))},dateToString:function(e){if(e){var t=new Date(parseInt(e));var n=BaseConnect.formatDateElement(t.getUTCMonth()+1);var r=BaseConnect.formatDateElement(t.getUTCDate());t=[n,r,t.getUTCFullYear()].join("-");return t}return e},dateTimeToString:function(e){if(e){var t=new Date(parseInt(e));var n=BaseConnect.formatDateElement(t.getUTCMonth()+1);var r=BaseConnect.formatDateElement(t.getUTCDate());var i=BaseConnect.formatDateElement(t.getUTCHours());var s=BaseConnect.formatDateElement(t.getUTCMinutes());var o=BaseConnect.formatDateElement(t.getUTCSeconds());var u=[n,r,t.getUTCFullYear()].join("-");var a=parseInt(i)>=12?"pm":"am";i=i%12;i=i?i:12;u+=" ";u+=[i,s].join(":");u+=" "+a;return u}return e},durationToString:function(e){var t="0";if(e){t=parseInt(e)/36e5}return t.toString()+" hours"},timeOfDayToString:function(e){var t="";if(e){t=new Date;t.setHours("");t.setMinutes("");t.setSeconds("");t=t.setMilliseconds(e);t=new Date(t);var n=parseInt(t.getHours());var r=t.getMinutes().toString();var i="am";if(n>=12){i="pm";if(n>12){n=n-12}}if(r.length==1){r="0"+r}t=n.toString()+":"+r+" "+i}return t},redirectToEditForm:function(e,t){window.location="/db/"+e+"?a=er&rid="+t},redirectToViewForm:function(e,t){window.location="/db/"+e+"?a=dr&rid="+t},downloadFile:function(e,t,n,r){if(!r){r=0}window.location="https://www.quickbase.com/up/"+e+"/a/r"+t+"/e"+n+"/v"+r},base64Encode:function(e){var t="";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var r,i,s,o,u,a,f;var l=0;var c=e.replace(/\r\n/g,"\n");var h="";for(var p=0;p<c.length;p++){var d=c.charCodeAt(p);if(d<128){h+=String.fromCharCode(d)}else if(d>127&&d<2048){h+=String.fromCharCode(d>>6|192);h+=String.fromCharCode(d&63|128)}else{h+=String.fromCharCode(d>>12|224);h+=String.fromCharCode(d>>6&63|128);h+=String.fromCharCode(d&63|128)}}e=h;while(l<e.length){r=e.charCodeAt(l++);i=e.charCodeAt(l++);s=e.charCodeAt(l++);o=r>>2;u=(r&3)<<4|i>>4;a=(i&15)<<2|s>>6;f=s&63;if(isNaN(i)){a=f=64}else if(isNaN(s)){f=64}t=t+n.charAt(o)+n.charAt(u)+n.charAt(a)+n.charAt(f)}return t}};var BaseConnect={apptoken:null,async:null,post:function(e,t,n){var r=this.buildRequest();var i="API";for(key in e.params){var s=e.params[key];if(key=="clist"||key=="slist"||key=="options"){if(Object.prototype.toString.call(s)=="[object Array]"){s=s.join(".")}}this.addParameter(r,key,s)}for(key in e.fieldParams){this.addFieldParameter(r,key,e.fieldParams[key])}if(e.type){i=e.type}if(e.csvData){var o=r.createElement("records_csv");o.appendChild(r.createCDATASection(e.csvData));r.documentElement.appendChild(o)}response=this.xmlPost(e.dbid,i+"_"+e.action,r,t,n);return response},formatDateElement:function(e){e=e.toString();if(e.length==1){e="0"+e}return e},getNode:function(e,t){return $(e).find(t).text()},getRecords:function(e){var t=$(e).find("records").find("record");var n=[];for(var r=0;r<t.length;r++){var i=t[r];var s=$(i).find("f");i={};for(var o=0;o<s.length;o++){var u=s[o];var a=parseInt($(u).attr("id"));if($(u).find("url").text()!=""){var f=$(u).find("url").text();var l=f.split("/");var c=l[l.length-1];var h={filename:c,url:f}}else{var h=$(u).text()}i[a]=h}n.push(i)}return n},getRids:function(e){var t=$(e).find("records").find("record");var n=[];for(var r=0;r<t.length;r++){var i=t[r];n.push($(i).find('f[id="3"]').text())}return n},getNewRids:function(e){var t=$(e).find("rids").find("rid");var n=[];for(var r=0;r<t.length;r++){var i=parseInt($(t[r]).text());n.push(i)}return n},getFields:function(e){var t=$(e).find("fields").find("field");var n={};for(var r=0;r<t.length;r++){var i=t[r];var s={label:$(i).find("label").text(),nowrap:$(i).find("nowrap").text(),bold:$(i).find("bold").text(),required:$(i).find("required").text(),appears_by_default:$(i).find("appears_by_default").text(),find_enabled:$(i).find("find_enabled").text(),allow_new_choices:$(i).find("allow_new_choices").text(),sort_as_given:$(i).find("sort_as_given").text(),carrychoices:$(i).find("carrychoices").text(),foreignkey:$(i).find("foreignkey").text(),unique:$(i).find("unique").text(),doesdatacopy:$(i).find("doesdatacopy").text(),fieldhelp:$(i).find("fieldhelp").text(),display_user:$(i).find("display_user").text(),default_kind:$(i).find("default_kind").text()};n[$(i).attr("id")]=s}return n},getReports:function(e){var t=$(e).find("queries").find("query");var n={};for(var r=0;r<t.length;r++){var i=t[r];var s={name:$(i).find("qyname").text(),type:$(i).find("qytype").text(),criteria:$(i).find("qycrit").text(),clist:$(i).find("qyclst").text(),slist:$(i).find("qyslst").text(),options:$(i).find("qyopts").text()};n[$(i).attr("id")]=s}return n},formatUserRoles:function(e){var t=$(e).find("users").find("user");var n=[];for(var r=0;r<t.length;r++){var i=t[r];var s=$(i).find("roles").find("role");var o=[];for(var u=0;u<s.length;u++){var a=s[u];var f={id:$(a).attr("id"),name:$(a).find("name").text(),accessId:$(a).find("access").attr("id"),access:$(a).find("access").text()};o.push(f)}var l={id:$(i).attr("id"),firstName:$(i).find("firstName").text(),lastName:$(i).find("lastName").text(),lastAccess:$(i).find("lastAccess").text(),lastAccessAppLocal:$(i).find("lastAccessAppLocal").text(),roles:o};n.push(l)}return n},createDocument:function(){try{if(window.ActiveXObject!==undefined){return new ActiveXObject("Microsoft.XmlDom")}if(document.implementation&&document.implementation.createDocument){var e=document.implementation.createDocument("","",null);return e}}catch(t){}throw new Error("Sorry. Your browser does not support Base.js.")},buildRequest:function(){var e=this.createDocument();e.async=this.async;e.resolveExternals=false;var t=e.createElement("qdbapi");try{e.removeChild(e.documentElement)}catch(n){}e.appendChild(t);if(this.apptoken){this.addParameter(e,"apptoken",this.apptoken)}return e},addParameter:function(e,t,n){var r=e.documentElement;var i=e.createElement(t);var s=e.createTextNode(n);i.appendChild(s);r.appendChild(i)},addFieldParameter:function(e,t,n){var r=e.documentElement;var i=e.createElement("field");i.setAttribute("fid",t);if(n){if(n.filename){i.setAttribute("filename",n.filename);n=BaseHelpers.base64Encode(n.body)}}var s=e.createTextNode(n);i.appendChild(s);r.appendChild(i)},xmlPost:function(e,t,n,r,i){var s="/db/"+e+"?act="+t;if(this.async==true){var o=BaseConnect.initHttpConnection()}else{var o=Base.httpConnection}o.open("POST",s,this.async);if(/MSIE 1/i.test(navigator.appVersion)||window.ActiveXObject!==undefined){try{o.responseType="msxml-document"}catch(u){}}if(this.async==true){o.onreadystatechange=function(){if(o.readyState==4&&o.status==200){var e=BaseConnect.parseResponse(o);e=i(e);r(e)}}}o.setRequestHeader("Content-Type","text/xml");o.send(n);if(this.async==false){var a=BaseConnect.parseResponse(o);return i(a)}},parseResponse:function(e){var t=e.responseXML;var n=BaseConnect.getNode(t,"errcode");if(n!="0"){console.log("*****ERROR*****: ("+BaseConnect.getNode(t,"action")+")"+"(CODE: "+n+")","MESSAGE: "+BaseConnect.getNode(t,"errtext")+" - "+BaseConnect.getNode(t,"errdetail"))}this.ticket=BaseConnect.getNode(t,"ticket");return t},setVariables:function(e,t){this.apptoken=e;this.async=t||false},initHttpConnection:function(){var e=null;try{if(!e){e=new XMLHttpRequest}}catch(t){}try{if(!e){e=new ActiveXObject("Msxml2.XMLHTTP")}}catch(t){}try{if(!e){e=new ActiveXObject("Microsoft.XMLHTTP")}}catch(t){alert("This browser does not support BaseJS.")}return e}}